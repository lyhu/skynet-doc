# 2.2 服务定义

## 1. 功能说明

服务定义功能是将服务的相关运行配置，注册配置到集群。通过点击控制台下面的服务定义，进入到服务定义页面。下面是页面显示，左侧是应用系统列表，右侧是服务定义列表

![](../.gitbook/assets/image%20%2856%29.png)

## 2. 功能详细

### 2.1 应用系统

应用系统，相当于plugin组件，每个应用系统，包含一个或多个服务定义

在页面上点击“新增应用系统”，弹出新增应用系统弹出框

![](../.gitbook/assets/image%20%2811%29.png)

在弹出框里填写新增应用系统信息，包括系统名称、系统标题、系统描述和系统版本，**这四个字段默认都是必填。**

![](../.gitbook/assets/image%20%2838%29.png)

点击保存后，可以在左侧应用系统列表里面，看到刚刚添加的“能力服务-自动编目服务”，右侧是该应用系统的服务列表和资源列表，其中，资源列表是该应用系统下所有服务共用

![](../.gitbook/assets/image%20%2840%29.png)

可以通过点击浏览文件，对小于100MB的文件进行上传。对于超过100MB的文件，建议使用FTP/SCP方式，将文件放到资源文件目录，如果资源目录不存在，则新建

![](../.gitbook/assets/image%20%2845%29.png)

通过xManager管理工具定义系统（插件）、服务运行参数配置

新增服务时，填写所属系统、服务名称等基本信息，选择服务类型，主要有以下几种类型

* **SkynetBoot：**按照skynet开发规范开发的服务，主要指的是各种能力服务以及一些基础服务
* **SpringBoot：**利用SpringBoot技术封装的工程，以SpringBoot方式进行启动
* **JavaBoot：**能够启动的java工程，以jar包方式进行启动
* **BaseBoot：**能够使用命令进行启动的任意进程

配置存放位置：zkPath=/skynet/plugin 

### 2.2 服务定义

#### 2.2.1 基本信息：

![](../.gitbook/assets/image%20%2814%29.png)

###  

> **启用网关：**支持所有类型服务，通过网关桥服务注册到网关服务，具体参加《服务发现与网关注册》
>
> **日志采集：**只正对SpringBoot服务，通过agent注入logger 的SocketAppeder来收集日志，具体参考《日志采集》
>
> **Eureka服务发现：**只针对SpringBoot服务，在服务启动时注入当前集群的Eureka服务地址，让其自动连接Eureak注册中心

#### **2.2.2 运行参数**

主要是运行环境变量设置，如端口设置、开关属性设置等

![](../.gitbook/assets/image%20%2857%29.png)

#### **2.2.3 环境变量**

如引擎服务系统环境设置，运行资源库加载等

![](../.gitbook/assets/image%20%2836%29.png)

#### **2.2.4 健康检查**

可以选择是否打开，开启后选择健康检测路径、检测间隔等，如达到一定的失败次数，认为此服务僵死，将直接KILL服务进程。（如果实际的服务不存在，有另外的机制保障不检测了）

![](../.gitbook/assets/image%20%2863%29.png)

#### **2.2.5 文件更新**

可以选择启动或者关闭，选择下载url以及下载目标路径，此项功能变相实现了服务的自动更新部署。

![](../.gitbook/assets/image%20%2852%29.png)

#### **2.2.6日志配置**

配置服务的日志级别，格式：命名空间=INFO\|DEBUG\|ERROR

![](../.gitbook/assets/image%20%2873%29.png)

#### **2.2.7 属性配置**

设置服务用到的属性配置信息，以 KEY=VALUE 形式，配置规则与application.properties一致，如数组

```coffeescript
ips[0]=192.168.83.203
ips[1]=192.168.83.204
```

![](../.gitbook/assets/image%20%2846%29.png)

