# 2.3 服务分配

## 1. 功能说明

 在集群服务器上分配运行服务实例，可以选择单个服务器或者多个服务器，分配服务时可以选择服务实例数量。

## 2. 功能详细

### 2.1 单服务器服务分配

选中要进行服务分配的单个服务器，点击“操作”，在下拉选项中选择“服务分配”

![](../.gitbook/assets/image%20%2849%29.png)

下面是弹出的服务分配页面，下面是具体区域介绍

* 区域1：选中的服务器ip地址，为该ip地址分配服务器
* 区域2：zk上**已经导入的所有服务**定义
* 区域3：选中服务上已经分配的服务数量
* 区域4：选中服务器上已经分配的服务详情及实例数

![](../.gitbook/assets/image%20%287%29.png)

选择需要进行分配的服务，点击“+”，则需要进行分配的服务就移动到了右侧，也可以通过拖拽的形式直接将要分配的服务由左侧拖拽到右侧。下拉选择分配服务的实例数（默认为1），点击“确定”后，分配的服务自动启动

![](../.gitbook/assets/image%20%28117%29.png)

回到管理页面可以看到服务器上新增了4个分配的服务，需要注意的是，多实例分配的服务不能指定固定端口，否则会因为占用端口冲突，导致部分实例启动失败

![](../.gitbook/assets/image%20%28101%29.png)

### 2.2  多服务器服务分配

服务分配功能还可以进行多个服务器的服务分配功能，选中要进行服务分配的多个服务器，点击下方的“更多”，在弹出框里选择“服务分配”

![](../.gitbook/assets/image%20%2851%29.png)

弹出服务分配界面，上面是要进行服务分配的多个服务器ip，左侧是需要能够进行服务分配的服务列表。**需要注意的是，右侧是多个服务具有的已分配的服务的共同部分，其不同部分将会在服务分配时进行关闭，这点需要特别注意**

![](../.gitbook/assets/image%20%28104%29.png)

点击“确定”后，可以看到这两台服务器都启动了刚刚分配的服务，其中一台启动成功，一台启动失败，对于启动失败的服务器，根据日志进行排查，然后重启服务即可

![](../.gitbook/assets/image%20%28123%29.png)

### 2.3 新注册服务器服务分配

skynet集群支持服务器的快速部署，对于新服务器的服务部署，直接为其分配服务即可完成服务的部署，但是有以下几点需要注意

* 新注册的服务器，需要具备分配环境的授权，具体情况根据具体服务确定
* 需要在xmanager服务器所在的服务器，准备好服务部署所属的资源包，具体可以参考 [**2.2服务定义一节**](https://skynet.gitbook.io/project/~/edit/drafts/-LPi4gtYKYARzxmqFcDa/2.-fu-wu-tuo-guan/2.2-fu-wu-ding-yi)\*\*\*\*

下面介绍详细步骤，首先对另一台主机进行注册，点击保存后，会将skynet平台部署包拷贝到另一台服务器 

![](../.gitbook/assets/image%20%2876%29.png)

 然后在界面上能看到刚刚分配的该服务器 

![](../.gitbook/assets/image%20%28118%29.png)

 在服务器右侧选择操作，点击启动服务器 

![](../.gitbook/assets/image%20%28125%29.png)

 然后选择服务分配，选择OCR同步服务，进行分配即可 

![](../.gitbook/assets/image%20%2821%29.png)

 服务所需插件包与资源包会自动拷贝到该服务器，服务启动

![](../.gitbook/assets/image%20%28113%29.png)

